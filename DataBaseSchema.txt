CREATE schema Library;
USE Library;

CREATE TABLE BOOK(Book_id VARCHAR (10) NOT NULL,Title VARCHAR(100),PRIMARY KEY ( book_id ));

CREATE TABLE BOOK_AUTHORS(Book_id VARCHAR(10) NOT NULL,Author_name VARCHAR(20) NOT NULL,Fname VARCHAR(20) default NULL,Minit VARCHAR(20) default NULL,Lname VARCHAR(20) default NULL,PRIMARY KEY (Book_id,Author_name),FOREIGN KEY (Book_id) REFERENCES BOOK(Book_id) ON DELETE CASCADE);

CREATE TABLE LIBRARY_BRANCH(Branch_id INT NOT NULL,Branch_name VARCHAR(20),Address VARCHAR(50), PRIMARY KEY ( Branch_id ));
CREATE TABLE BOOK_COPIES(Book_id VARCHAR(10) NOT NULL,Branch_id INT NOT NULL,No_of_copies INT,FOREIGN KEY (Book_id) REFERENCES BOOK(Book_id) ON DELETE CASCADE ON UPDATE CASCADE,FOREIGN KEY (Branch_id) REFERENCES LIBRARY_BRANCH(Branch_id) ON DELETE CASCADE ON UPDATE CASCADE);

CREATE TABLE BORROWER(Card_no INT NOT NULL,Fname VARCHAR(20) NOT NULL,Lname VARCHAR(20) NOT NULL,Address VARCHAR(50) NOT NULL,Phone VARCHAR(20), PRIMARY KEY ( Card_no ));

CREATE TABLE BOOK_LOANS(Loan_id INT NOT NULL AUTO_INCREMENT,Book_id VARCHAR(10) NOT NULL,Branch_id INT NOT NULL,Card_no INT NOT NULL,date_out DATE,due_date DATE,date_in DATE,PRIMARY KEY (Loan_id),FOREIGN KEY (Book_id) REFERENCES BOOK(Book_id) ON DELETE CASCADE ON UPDATE CASCADE,FOREIGN KEY (Branch_id) REFERENCES LIBRARY_BRANCH(Branch_id) ON DELETE CASCADE ON UPDATE CASCADE,FOREIGN KEY (Card_no) REFERENCES BORROWER(Card_no) ON DELETE CASCADE ON UPDATE CASCADE);

CREATE TABLE FINES(Loan_id INT NOT NULL ,Fine_amt DECIMAL(5,2) ZEROFILL NOT NULL, Paid TINYINT(1) ZEROFILL NOT NULL, PRIMARY KEY(Loan_id),FOREIGN KEY (Loan_id) REFERENCES BOOK_LOANS(Loan_id) ON DELETE CASCADE ON UPDATE CASCADE);